<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Products - MyStore</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            padding-top: 56px;
        }
        .product-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
            height: 100%;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .card-title {
            font-weight: 600;
            color: #343a40;
            font-size: 1rem;
        }
        .card-img-top {
            height: 200px;
            object-fit: cover;
        }
        .footer {
            background-color: #343a40;
            color: #f8f9fa;
            padding: 40px 20px;
            margin-top: 50px;
            text-align: center;
        }
        .btn-container {
            margin-top: auto;
        }
        .page-banner {
            background-color: #e9ecef;
            padding: 30px 0;
            margin-bottom: 30px;
        }
        .filter-sidebar {
            background-color: white;
            border-radius: 5px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .price-range {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .price-input {
            width: 80px;
        }
        #products-container {
            min-height: 400px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">MyStore</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="products.html">All Products</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="categoriesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Categories
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="categoriesDropdown" id="category-dropdown">
                            <li><a class="dropdown-item" href="products.html">All Categories</a></li>
                            <!-- Categories will be populated dynamically -->
                        </ul>
                    </li>
                </ul>
                <form class="d-flex me-2">
                    <input class="form-control me-2" type="search" placeholder="Search products..." aria-label="Search" id="search-input">
                    <button class="btn btn-outline-light" type="submit">Search</button>
                </form>
                <ul class="navbar-nav ms-auto">
                     <li class="nav-item">
                        <a class="nav-link" href="wishlist_manager.html"><i class="fas fa-heart"></i> Wishlist</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="order_placement.html"><i class="fas fa-shopping-cart"></i> Cart</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownAccount" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user"></i> Account
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownAccount">
                            <li><a class="dropdown-item" href="order_status.html">Order Status</a></li>
                            <li><a class="dropdown-item" href="track_shipment.html">Track Shipment</a></li>
                            <li><a class="dropdown-item" href="product_review.html">Product Reviews</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="page-banner">
        <div class="container">
            <h1>All Products</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Products</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <!-- Filter Sidebar -->
            <div class="col-md-3 mb-4">
                <div class="filter-sidebar">
                    <h5 class="mb-3">Filter Products</h5>
                    
                    <div class="mb-3">
                        <label class="form-label">Sort By</label>
                        <select class="form-select" id="sort-select">
                            <option value="name_asc">Name (A-Z)</option>
                            <option value="name_desc">Name (Z-A)</option>
                            <option value="price_asc">Price (Low to High)</option>
                            <option value="price_desc">Price (High to Low)</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Price Range</label>
                        <div class="price-range">
                            <input type="number" class="form-control price-input" id="min-price" placeholder="Min">
                            <span>to</span>
                            <input type="number" class="form-control price-input" id="max-price" placeholder="Max">
                        </div>
                    </div>
                    
                    <div class="mb-3" id="category-filters">
                        <label class="form-label">Categories</label>
                        <!-- Category checkboxes will be populated dynamically -->
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="all" id="cat-all" checked>
                            <label class="form-check-label" for="cat-all">
                                All Categories
                            </label>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary w-100 mt-3" id="apply-filters">Apply Filters</button>
                    <button class="btn btn-outline-secondary w-100 mt-2" id="reset-filters">Reset Filters</button>
                </div>
            </div>
            
            <!-- Products Grid -->
            <div class="col-md-9">
                <div class="mb-4 d-flex justify-content-between align-items-center">
                    <div>
                        <span id="product-count">0</span> products found
                    </div>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-secondary active" id="grid-view">
                            <i class="fas fa-th"></i>
                        </button>
                        <button type="button" class="btn btn-outline-secondary" id="list-view">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
                
                <div class="row" id="products-container">
                    <!-- Products will be loaded dynamically -->
                    <div class="text-center py-5">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p>Loading products...</p>
                    </div>
                </div>
                
                <!-- Pagination -->
                <nav aria-label="Product pagination" class="mt-4">
                    <ul class="pagination justify-content-center" id="pagination">
                        <!-- Pagination will be generated dynamically -->
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>MyStore</h5>
                    <p>Your favorite online store.</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">About Us</a></li>
                        <li><a href="#" class="text-white">Contact</a></li>
                        <li><a href="#" class="text-white">FAQ</a></li>
                        <li><a href="#" class="text-white">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Follow Us</h5>
                    <a href="#" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <hr style="border-color: rgba(255, 255, 255, 0.1);">
            <p class="mb-0">&copy; 2024 MyStore. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global variables
        let allProducts = [];
        let filteredProducts = [];
        let currentPage = 1;
        const productsPerPage = 12;
        let viewMode = 'grid'; // 'grid' or 'list'
        
        // DOM elements
        const productsContainer = document.getElementById('products-container');
        const pagination = document.getElementById('pagination');
        const productCount = document.getElementById('product-count');
        const sortSelect = document.getElementById('sort-select');
        const minPriceInput = document.getElementById('min-price');
        const maxPriceInput = document.getElementById('max-price');
        const applyFiltersBtn = document.getElementById('apply-filters');
        const resetFiltersBtn = document.getElementById('reset-filters');
        const gridViewBtn = document.getElementById('grid-view');
        const listViewBtn = document.getElementById('list-view');
        const searchInput = document.getElementById('search-input');
        
        // Load products when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Fetch products
            fetch('get_products.php')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        allProducts = data.products;
                        filteredProducts = [...allProducts];
                        
                        // Update product count
                        productCount.textContent = allProducts.length;
                        
                        // Sort products by default (name A-Z)
                        sortProducts('name_asc');
                        
                        // Display first page
                        displayProductPage(1);
                        
                        // Generate pagination
                        generatePagination();
                    } else {
                        productsContainer.innerHTML = 
                            `<div class="col-12 text-center">
                                <div class="alert alert-danger">Error loading products: ${data.message}</div>
                            </div>`;
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    productsContainer.innerHTML = 
                        `<div class="col-12 text-center">
                            <div class="alert alert-danger">Failed to load products. Please refresh the page.</div>
                        </div>`;
                });
            
            // Event listeners
            sortSelect.addEventListener('change', function() {
                sortProducts(this.value);
                displayProductPage(1);
                generatePagination();
            });
            
            applyFiltersBtn.addEventListener('click', function() {
                applyFilters();
                displayProductPage(1);
                generatePagination();
            });
            
            resetFiltersBtn.addEventListener('click', function() {
                resetFilters();
                displayProductPage(1);
                generatePagination();
            });
            
            gridViewBtn.addEventListener('click', function() {
                setViewMode('grid');
            });
            
            listViewBtn.addEventListener('click', function() {
                setViewMode('list');
            });
            
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    applyFilters();
                    displayProductPage(1);
                    generatePagination();
                }
            });
        });
        
        // Set view mode (grid or list)
        function setViewMode(mode) {
            viewMode = mode;
            
            if (mode === 'grid') {
                gridViewBtn.classList.add('active');
                listViewBtn.classList.remove('active');
            } else {
                gridViewBtn.classList.remove('active');
                listViewBtn.classList.add('active');
            }
            
            displayProductPage(currentPage);
        }
        
        // Apply filters
        function applyFilters() {
            const minPrice = minPriceInput.value ? parseFloat(minPriceInput.value) : 0;
            const maxPrice = maxPriceInput.value ? parseFloat(maxPriceInput.value) : Number.MAX_VALUE;
            const searchTerm = searchInput.value.toLowerCase();
            
            filteredProducts = allProducts.filter(product => {
                const price = parseFloat(product.price);
                const matchesPrice = price >= minPrice && price <= maxPrice;
                
                const matchesSearch = searchTerm === '' || 
                    product.name.toLowerCase().includes(searchTerm) ||
                    (product.description && product.description.toLowerCase().includes(searchTerm));
                
                return matchesPrice && matchesSearch;
            });
            
            productCount.textContent = filteredProducts.length;
            sortProducts(sortSelect.value);
        }
        
        // Reset filters
        function resetFilters() {
            minPriceInput.value = '';
            maxPriceInput.value = '';
            searchInput.value = '';
            sortSelect.value = 'name_asc';
            
            filteredProducts = [...allProducts];
            productCount.textContent = filteredProducts.length;
            sortProducts('name_asc');
        }
        
        // Sort products
        function sortProducts(sortBy) {
            switch (sortBy) {
                case 'name_asc':
                    filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name_desc':
                    filteredProducts.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'price_asc':
                    filteredProducts.sort((a, b) => parseFloat(a.price) - parseFloat(b.price));
                    break;
                case 'price_desc':
                    filteredProducts.sort((a, b) => parseFloat(b.price) - parseFloat(a.price));
                    break;
            }
        }
        
        // Display products for the current page
        function displayProductPage(page) {
            currentPage = page;
            productsContainer.innerHTML = '';
            
            const startIndex = (page - 1) * productsPerPage;
            const endIndex = Math.min(startIndex + productsPerPage, filteredProducts.length);
            
            if (filteredProducts.length === 0) {
                productsContainer.innerHTML = 
                    `<div class="col-12 text-center">
                        <div class="alert alert-info">No products found matching your criteria.</div>
                    </div>`;
                return;
            }
            
            for (let i = startIndex; i < endIndex; i++) {
                const product = filteredProducts[i];
                const productElement = document.createElement('div');
                
                // Image URL (placeholder if not available)
                const imageUrl = product.image_url || `https://via.placeholder.com/300x200.png?text=${encodeURIComponent(product.name)}`;
                
                if (viewMode === 'grid') {
                    productElement.className = 'col-md-6 col-lg-4 mb-4';
                    productElement.innerHTML = `
                        <div class="card product-card">
                            <img src="${imageUrl}" class="card-img-top" alt="${product.name}">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text"><strong>$${parseFloat(product.price).toFixed(2)}</strong></p>
                                <p class="card-text small">${product.description ? product.description.substring(0, 60) + '...' : 'No description available'}</p>
                                <div class="btn-container mt-auto text-center">
                                    <a href="product_details.html?id=${product.product_id}" class="btn btn-outline-secondary btn-sm me-1">View</a>
                                    <a href="order_placement.html?product_id=${product.product_id}" class="btn btn-primary btn-sm">Add to Cart</a>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    productElement.className = 'col-12 mb-3';
                    productElement.innerHTML = `
                        <div class="card">
                            <div class="row g-0">
                                <div class="col-md-3">
                                    <img src="${imageUrl}" class="img-fluid rounded-start" alt="${product.name}" style="height: 100%; object-fit: cover;">
                                </div>
                                <div class="col-md-9">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="card-title">${product.name}</h5>
                                            <h5 class="text-primary">$${parseFloat(product.price).toFixed(2)}</h5>
                                        </div>
                                        <p class="card-text">${product.description || 'No description available'}</p>
                                        <div class="mt-3">
                                            <a href="product_details.html?id=${product.product_id}" class="btn btn-outline-secondary btn-sm me-1">View Details</a>
                                            <a href="order_placement.html?product_id=${product.product_id}" class="btn btn-primary btn-sm">Add to Cart</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                productsContainer.appendChild(productElement);
            }
        }
        
        // Generate pagination
        function generatePagination() {
            pagination.innerHTML = '';
            
            const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
            
            if (totalPages <= 1) {
                return;
            }
            
            // Previous button
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevLi.innerHTML = `<a class="page-link" href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>`;
            prevLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (currentPage > 1) {
                    displayProductPage(currentPage - 1);
                    generatePagination();
                }
            });
            pagination.appendChild(prevLi);
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageLi = document.createElement('li');
                pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
                pageLi.addEventListener('click', function(e) {
                    e.preventDefault();
                    displayProductPage(i);
                    generatePagination();
                });
                pagination.appendChild(pageLi);
            }
            
            // Next button
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
            nextLi.innerHTML = `<a class="page-link" href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>`;
            nextLi.addEventListener('click', function(e) {
                e.preventDefault();
                if (currentPage < totalPages) {
                    displayProductPage(currentPage + 1);
                    generatePagination();
                }
            });
            pagination.appendChild(nextLi);
        }
    </script>
</body>
</html> 